#No correr lo que esta comentado ni correr todo de una vez
#Para crear la base utilizamos el siguiente codigo

CREATE KEYSPACE IF NOT EXISTS tu_base_de_datos WITH replication = { 'class': 'SimpleStrategy', 'replication_factor': 1 };

#Para usar la base
USE tu_base_de_datos;

#Para crear la tabla segun los datos brindados

#Segun intentos de subir el csv
#Intento 1
CREATE columnfamily IF NOT EXISTS ventas (row_id INT PRIMARY KEY, order_id VARCHAR, order_date VARCHAR, ship_date VARCHAR, ship_mode VARCHAR, customer_id VARCHAR, customer_name VARCHAR, segment VARCHAR, country VARCHAR, city VARCHAR, state VARCHAR, postal_code INT, region VARCHAR, product_id VARCHAR, category VARCHAR, sub_category VARCHAR, product_name VARCHAR, sales FLOAT, quantity INT, discount FLOAT, profit FLOAT );

#intento 2
CREATE table IF NOT EXISTS ventas (row_id INT PRIMARY KEY, order_id VARCHAR, order_date VARCHAR, ship_date VARCHAR, ship_mode VARCHAR, customer_id VARCHAR, customer_name VARCHAR, segment VARCHAR, country VARCHAR, city VARCHAR, state VARCHAR, postal_code INT, region VARCHAR, product_id VARCHAR, category VARCHAR, sub_category VARCHAR, product_name VARCHAR, sales FLOAT, quantity INT, discount FLOAT, profit FLOAT );

#intento3#
CREATE table IF NOT EXISTS ventas (row_id VARCHAR PRIMARY KEY, order_id VARCHAR, order_date VARCHAR, ship_date VARCHAR, ship_mode VARCHAR, customer_id VARCHAR, customer_name VARCHAR, segment VARCHAR, country VARCHAR, city VARCHAR, state VARCHAR, postal_code VARCHAR, region VARCHAR, product_id VARCHAR, category VARCHAR, sub_category VARCHAR, product_name VARCHAR, sales VARCHAR, quantity VARCHAR, discount VARCHAR, profit VARCHAR );

#Para verificar la creacion de la misma
DESCRIBE TABLE ventas;

#Para verificar de nuevo
USE tu_base_de_datos;

#Otra manera de verificar
SELECT * FROM ventas LIMIT 5;


#Intentos de insertar el csv por comando
#insertar csv
COPY ventas(row_id, order_id, order_date, ship_date, ship_mode, customer_id, customer_name, segment, country, city, state, postal_code, region, product_id, category, sub_category, product_name, sales, quantity, discount, profit) FROM 'VentasElectronicos.csv' WITH delimiter =',' and HEADER = TRUE; 

#Prueba pequena
USE tu_base_de_datos;
COPY ventas(row_id) FROM 'VentasElectronicos.csv' WITH delimiter =',' and HEADER = TRUE; 


